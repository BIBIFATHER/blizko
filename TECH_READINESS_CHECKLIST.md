# Tech Readiness Checklist — Blizko

## 1) Quality Base (Качество базы)
**Tech checklist**
- Документы: загрузка → хранение → просмотр (parent/nanny)
- Статусы верификации: `pending/verified/rejected` + история изменений
- Админ‑оверрайд статуса и причины
- Согласия на обработку/хранение (CONSENT_TEXT)
- Безопасность: RLS, `user_id` сохраняется, приватные файлы
- Логи проверок (аудит, время, кто изменил)
- Флоу рекомендаций (2 контакта) — структура/валидация
- OSINT/след: поля/флаги наличия проверки

**Dependencies**
- OCR/MRZ/face‑match провайдер, storage (Supabase storage), Legal/Privacy, RLS политики

**Risks**
- Ложные/пропущенные проверки
- Приватность и хранение доков
- Неполные/битые документы

**Fix plan**
- Фолбек на ручную проверку (admin “manual verified”)
- Блок автопрохода при ошибках AI
- Ре‑запрос документов с шаблонным сообщением
- Очередь повторной обработки + ретраи
- Временное отключение OSINT/AI, если стабильность падает

---

## 2) Compatibility (Совместимость / Mirror+/PCM)
**Tech checklist**
- Анкеты: обязательные поля + валидация
- AI‑matching API контракт стабилен (`/api/ai`)
- Объяснимость: текст “почему эта няня”
- Балл/скоринг выводится на UI
- Фидбэк после визита сохранён и привязан к матчу
- Логи инпутов/аутпутов (для отладки)

**Dependencies**
- AI API лимиты/таймауты, данные из анкет, контент‑политики

**Risks**
- Нестабильные/галлюцинаторные ответы
- Смещения/необъективность
- Непредсказуемая выдача при схожих данных

**Fix plan**
- Детерминированный базовый rule‑matching (fallback)
- Кэширование совпадений по ключевым полям
- Контроль “минимального качества” ответа (reject‑and‑retry)
- Снижение креативности модели + шаблоны объяснений

---

## 3) Stability (Гарантия прихода)
**Tech checklist**
- Модель событий: запрос → hold → подтверждение → назначение
- Тайм‑блоки и double‑reserve
- T‑24h и T‑3/4h подтверждения (email/SMS)
- Админ‑переназначение/замена няни
- Учет таймзоны и дедлайнов
- Журнал изменений статусов

**Dependencies**
- Нотификации (SMS/email/push), календарь/слоты, ops процесс

**Risks**
- Двойное бронирование
- Потеря подтверждений (сбои нотификаций)
- “No show” без резерва

**Fix plan**
- Идемпотентность операций (hold/confirm)
- Лок/atomic update на слот
- Фолбек на админ‑ручное подтверждение
- Авто‑поднятие резерва при отсутствии ответа

---

## 4) Payments (Платежи/экономика)
**Tech checklist**
- Create payment + webhook (ЮKassa)
- Таблица `payments` + статусный флоу (created/paid/failed/refund)
- Проверка подписи webhook
- Идемпотентность по `payment_id`
- Связь платеж ↔ заказ/няня
- Логи операций + ручная сверка

**Dependencies**
- ЮKassa API, юридические условия/чеки, банковские ограничения

**Risks**
- Повторные списания (double charge)
- Пропуск webhook → “не видим оплату”
- Фрод/споры

**Fix plan**
- Двойная проверка статуса (pull after webhook)
- Retry‑механика webhook
- Ручная reconciliation‑таблица
- Возможность быстро отключить оплату и вернуться на “manual invoice”

---

## 5) Mobile (PWA / Capacitor)
**Tech checklist**
- PWA manifest/icons + install prompt
- Адаптивные формы (parent/nanny/admin)
- Производительность: LCP/CLS, lazy‑load
- Offline минимально: кэш статики + graceful errors
- iOS/Android проверки (Safari/Chrome)
- Capacitor wrapper (если требуется App Store)

**Dependencies**
- iOS PWA ограничения, App Store требования, push‑инфра

**Risks**
- Некорректные формы на iOS
- Нет push на iOS PWA
- Часть функций не работает в webview

**Fix plan**
- Деградация: email/SMS вместо push
- Feature‑flags для проблемных функций
- Быстрый rollback на PWA‑only без store
